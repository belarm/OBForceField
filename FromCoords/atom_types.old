#include <glm/vec3.hpp>
#include <string.h>
#include <string>
#include <iomanip>




#define _res(C,X) std::pair<char,Residue>((C),Residue((C),(X)))



using namespace std;
using namespace glm;

std::map<char,string> CtoCode = map<char,string>(
{
	pair<char,string>('A', "ALA"),
	pair<char,string>('B', "ASX"),
	pair<char,string>('C', "CYS"),
	pair<char,string>('D', "ASP"),
	pair<char,string>('E', "GLU"),
	pair<char,string>('F', "PHE"),
	pair<char,string>('G', "GLY"),
	pair<char,string>('H', "HIS"),
	pair<char,string>('I', "ILE"),
	pair<char,string>('J', "XLE"),
	pair<char,string>('K', "LYS"),
	pair<char,string>('L', "LEU"),
	pair<char,string>('M', "MET"),
	pair<char,string>('N', "ASN"),
	pair<char,string>('O', "PYL"),
	pair<char,string>('P', "PRO"),
	pair<char,string>('Q', "GLN"),
	pair<char,string>('R', "ARG"),
	pair<char,string>('S', "SER"),
	pair<char,string>('T', "THR"),
	pair<char,string>('U', "SEC"),
	pair<char,string>('V', "VAL"),
	pair<char,string>('W', "TRP"),
	pair<char,string>('Y', "TYR"),
	pair<char,string>('Z', "GLX")
}
);








class Atom {
public:
	Atom() {}
	Atom(string _type) {
		atype = _type;
		pos = dvec3(0,0,0);
	}
	Atom(string _type,dvec3 _pos) {
		atype = _type;
		pos = _pos;
	}
	Atom(string _type, double x, double y, double z) {
		atype = _type;
		pos = dvec3(x,y,z);
	}
	const string Type() { return atype; };
	
	string Lbl() {
		int o = atype.find_first_of("1234567890");
		if(o != string::npos) {
			return atype[o] + atype.substr(0,o);
//			return "DDD";
		} else {
			return " " + atype;
		}
	}
	double X() { return pos.x; }
	double Y() { return pos.y; }
	double Z() { return pos.z; }
	
	string element() {
		return atype.substr(0,1);
	}
	static dvec3 getPos(const Atom &a) {
		return a.pos;
	}
	dvec3 Pos() {
		return pos;
	}
private:
	string atype;
	dvec3 pos;
};

class Residue {
public:
	Residue() {
	}
	Residue(char rcode) {
		
	}
	Residue(char rcode, vector<Atom> _atoms) {
		code = rcode;
		atoms = _atoms;
//		for_each(atoms.begin(),atoms.end(),_map_code_to_atom());
		for_each(atoms.begin(),atoms.end(),[&](Atom a) {_lookup_atom.insert(pair<string,Atom *>(a.Type(),&a));});
	}
//	friend ostream& operator<<(ostream& os, Residue res) {
//		const Atom &a = res._get_atom_by_code("CA");
//		os << a.element() << '@' << to_string(Atom::getPos(a));
//		return os;
//	}
	vector<Atom> GetChildren(int root) {
		switch(root) {
			case 1:
				return vector<Atom>(
					_lookup_atom["N"],
					_lookup_atom["H"]
				);
			case 3:
				return vector<Atom>(
					_lookup_atom["C"],
					_lookup_atom["O"]
				);
//			default:
				
		}
	}
//	string Desc() {
//		string ret = RDB.ResName(
	dvec3 Pos() { return atoms.begin()->Pos();}
	char Code() { return code;}
	string Lbl() { return CtoCode[code]; };
	void MakeCIF(ofstream &ofs) {
		ofs << "data_" << Lbl() << endl;
		ofs << "#" << endl;
		ofs << "loop_\n";
		ofs << "_chem_comp_atom.comp_id\n";
		ofs << "_chem_comp_atom.atom_id\n";
		ofs << "_chem_comp_atom.model_Cartn_x\n";
		ofs << "_chem_comp_atom.model_Cartn_y\n";
		ofs << "_chem_comp_atom.model_Cartn_z\n";

		for(auto a : atoms) {
			ofs << Lbl() << " ";
			ofs.width(4);
			ofs << left << a.Lbl() << " ";
			ofs << a.X() << " ";
			ofs << a.Y() << " ";
			ofs << a.Z() << endl;
			
//
//			
////			ofs.width(6);
//			dvec3 pos = a.Pos();
//			ofs << "ATOM  ";
//			ofs.width(5);
//			ofs << offset++ << ' ';
//			ofs.width(5);
//			ofs << left << a.Lbl();
//			ofs.width(4);
//			ofs << Lbl();
////			ofs << ;
//			ofs << right << " ";
//			ofs.width(4);
//			ofs << resid << "    ";
//			ofs.width(8);
//			ofs << fixed << setprecision(3) << pos.x;
//			ofs.width(8);
//			ofs << fixed << setprecision(3) << pos.y;
//			ofs.width(8);
//			ofs << fixed << setprecision(3) << pos.z;
//			ofs.width(6);
//			ofs << fixed << setprecision(2) << 1.0f;
//			ofs.width(6);
//			ofs << fixed << setprecision(2) << 1.0f;
//			ofs.width(12);
//			ofs << right << a.element();
////			ofs << 
////			ofs << code;
//			ofs << endl;
			
		}
//		return line;
	}



private:
	char code;
	vector<Atom> atoms;
	map<string,Atom*> _lookup_atom;
	Atom* _get_atom_by_code(string code) {
		return _lookup_atom[code];
	}
};

typedef std::pair<char,Residue> rpair;


class ResidueDB {
private:
	std::map<char,Residue> _db;
//	std::map<string,
public:
	string Desc(Residue r) {
		return CtoCode[r.Code()] + " @ " + to_string(r.Pos());
	}
	ResidueDB() {
	_db.insert(_res('A',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.963,  2.292,  0.440},
		{ "C",  1.963,  1.608,  0.913},
		{ "O",  3.153,  1.742,  0.774},
		{ "CB",  0.285,  3.409,  0.741},
		{ "HA",  1.478,  2.999,  0.183},
		{ "H",  -0.969,  1.563,  0.159},
		{ "HB3",  -0.234,  3.243,  1.029},
		{ "HB2",  -0.449,  3.921,  0.565},
		{ "HB1",  1.041,  4.176,  0.802},
	})));
	_db.insert(_res('B',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.277,  1.956,  0.378},
		{ "C",  1.657,  2.111,  1.142},
		{ "O",  1.005,  2.285,  1.603},
		{ "H",  -0.460,  0.827,  0.439},
		{ "HA",  2.086,  1.697,  -0.015},
		{ "CB",  1.215,  3.490,  0.329},
		{ "CG",  2.563,  4.246,  0.369},
		{ "OD2",  2.446,  5.465,  0.396},
		{ "HB1",  0.858,  3.913,  0.070},
		{ "HB2",  0.481,  3.976,  0.508},
	})));
	_db.insert(_res('C',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.240,  2.044,  0.344},
		{ "C",  1.604,  1.920,  1.098},
		{ "O",  2.805,  2.688,  1.146},
		{ "CB",  1.076,  3.574,  0.377},
		{ "SG",  2.635,  4.388,  0.481},
		{ "H",  -0.547,  0.711,  0.326},
		{ "HA",  2.055,  1.955,  -0.029},
		{ "HB1",  0.759,  4.104,  0.137},
		{ "HB2",  0.290,  3.934,  0.563},
		{ "HG",  2.305,  4.962,  0.729},
	})));
	_db.insert(_res('D',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.277,  1.956,  0.378},
		{ "C",  1.657,  2.111,  1.142},
		{ "O",  1.005,  2.285,  1.603},
		{ "CB",  1.215,  3.490,  0.329},
		{ "CG",  2.563,  4.246,  0.369},
		{ "OD1",  3.587,  3.562,  0.350},
		{ "OD2",  2.446,  5.465,  0.396},
		{ "H",  -0.460,  0.827,  0.439},
		{ "HA",  2.086,  1.697,  -0.015},
		{ "HB1",  0.858,  3.913,  0.070},
		{ "HB2",  0.481,  3.976,  0.508},
	})));
	_db.insert(_res('E',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.910,  2.346,  0.444},
		{ "C",  1.926,  1.740,  0.913},
		{ "O",  3.102,  2.014,  0.814},
		{ "CB",  0.167,  3.467,  0.718},
		{ "CG",  -0.772,  4.293,  0.478},
		{ "CD",  -1.539,  5.337,  0.640},
		{ "OE1",  -1.316,  5.704,  0.855},
		{ "OE2",  -2.382,  6.019,  0.527},
		{ "HA",  1.444,  3.037,  0.191},
		{ "H",  -0.971,  1.494,  0.147},
		{ "HB2",  0.911,  4.214,  0.802},
		{ "HB1",  -0.414,  3.237,  0.989},
		{ "HG2",  -1.507,  3.741,  0.327},
		{ "HG1",  -0.174,  4.922,  0.331},
	})));
	_db.insert(_res('F',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.247,  2.025,  0.345},
		{ "C",  1.575,  1.945,  1.105},
		{ "O",  0.830,  1.957,  1.633},
		{ "CB",  1.129,  3.574,  0.392},
		{ "CG",  0.795,  4.509,  0.099},
		{ "CD1",  -0.543,  4.812,  0.040},
		{ "CD2",  1.809,  5.212,  -0.036},
		{ "CE1",  -0.863,  5.867,  -0.120},
		{ "CE2",  1.489,  6.326,  -0.170},
		{ "CZ",  0.153,  6.675,  -0.201},
		{ "H",  -0.577,  0.741,  0.345},
		{ "HA",  2.070,  1.915,  -0.029},
		{ "HB1",  0.375,  3.918,  0.590},
		{ "HB2",  2.072,  4.010,  0.494},
		{ "HD1",  -1.338,  4.286,  0.153},
		{ "HD2",  2.846,  4.963,  -0.001},
		{ "HE1",  -1.898,  6.114,  -0.150},
		{ "HE2",  2.276,  6.964,  -0.227},
		{ "HZ",  -0.097,  7.602,  -0.270},
	})));
	_db.insert(_res('G',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.248,  2.021,  0.345},
		{ "C",  1.569,  1.950,  1.106},
		{ "O",  0.839,  1.959,  1.616},
		{ "H",  -0.581,  0.747,  0.349},
		{ "HA1",  2.081,  1.949,  -0.021},
		{ "HA2",  1.177,  3.121,  0.379},
	})));
	_db.insert(_res('H',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.950,  2.280,  0.454},
		{ "C",  1.934,  1.609,  0.944},
		{ "O",  3.126,  1.770,  0.820},
		{ "CB",  0.255,  3.433,  0.731},
		{ "CG",  -0.659,  4.241,  0.496},
		{ "ND1",  -0.268,  5.058,  0.290},
		{ "CD2",  -1.970,  4.460,  0.547},
		{ "CE1",  -1.269,  5.817,  0.232},
		{ "NE2",  -2.293,  5.436,  0.342},
		{ "HA",  1.509,  2.939,  0.189},
		{ "H",  -0.977,  1.624,  0.127},
		{ "HB2",  1.020,  4.169,  0.809},
		{ "HB1",  -0.320,  3.247,  1.008},
		{ "HD1",  0.691,  5.179,  0.219},
		{ "HD2",  -2.632,  4.175,  0.736},
		{ "HE1",  -1.242,  6.719,  0.134},
	})));
	_db.insert(_res('I',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.249,  2.017,  0.346},
		{ "C",  1.562,  1.956,  1.107},
		{ "O",  2.768,  2.715,  1.159},
		{ "CB",  1.224,  3.599,  0.360},
		{ "CG1",  0.832,  4.480,  0.053},
		{ "CG2",  2.576,  4.245,  0.472},
		{ "CD1",  0.483,  5.914,  0.141},
		{ "H",  -0.587,  0.754,  0.351},
		{ "HA",  2.064,  1.835,  -0.033},
		{ "HB",  0.446,  3.960,  0.548},
		{ "HG11",  1.620,  4.608,  -0.116},
		{ "HG12",  -0.065,  4.164,  -0.078},
		{ "HG21",  2.532,  5.347,  0.462},
		{ "HG22",  2.875,  4.163,  0.725},
		{ "HG23",  3.408,  3.978,  0.307},
		{ "HD11",  0.147,  6.555,  0.006},
		{ "HD12",  -0.333,  5.998,  0.265},
		{ "HD13",  1.346,  6.470,  0.207},
	})));
	_db.insert(_res('J',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.249,  2.017,  0.346},
		{ "C",  1.562,  1.956,  1.107},
		{ "O",  2.768,  2.715,  1.159},
		{ "CB",  1.224,  3.599,  0.360},
		{ "CG1",  0.832,  4.480,  0.053},
		{ "CD1",  0.483,  5.914,  0.141},
		{ "H",  -0.587,  0.754,  0.351},
		{ "HA",  2.064,  1.835,  -0.033},
		{ "HB",  0.446,  3.960,  0.548},
		{ "HG11",  1.620,  4.608,  -0.116},
		{ "HG12",  -0.065,  4.164,  -0.078},
		{ "HD11",  0.147,  6.555,  0.006},
		{ "HD12",  -0.333,  5.998,  0.265},
	})));
	_db.insert(_res('K',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.947,  2.308,  0.444},
		{ "C",  1.917,  1.661,  0.940},
		{ "O",  3.102,  1.908,  0.855},
		{ "CB",  0.242,  3.451,  0.721},
		{ "CG",  -0.645,  4.320,  0.478},
		{ "CD",  -1.510,  5.312,  0.650},
		{ "CE",  -2.471,  6.121,  0.490},
		{ "NZ",  -3.334,  7.021,  0.612},
		{ "HA",  1.506,  2.980,  0.186},
		{ "H",  -0.957,  1.471,  0.178},
		{ "HB2",  1.001,  4.172,  0.813},
		{ "HB1",  -0.369,  3.228,  0.988},
		{ "HG2",  -1.317,  3.804,  0.304},
		{ "HG1",  -0.005,  4.988,  0.348},
		{ "HD2",  -0.851,  6.067,  0.731},
		{ "HD1",  -2.112,  4.877,  0.810},
		{ "HE2",  -3.107,  5.498,  0.378},
		{ "HE1",  -1.882,  6.791,  0.389},
		{ "HZ3",  -3.936,  6.560,  0.725},
		{ "HZ2",  -4.019,  7.560,  0.524},
		{ "HZ1",  -2.751,  7.795,  0.676},
	})));
	_db.insert(_res('L',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.930,  2.335,  0.438},
		{ "C",  1.911,  1.701,  0.925},
		{ "O",  3.096,  1.942,  0.837},
		{ "CB",  0.226,  3.473,  0.717},
		{ "CG",  -0.820,  4.280,  0.501},
		{ "CD1",  -1.494,  5.347,  0.691},
		{ "CD2",  -0.194,  5.223,  0.275},
		{ "HA",  1.500,  2.994,  0.182},
		{ "H",  -0.954,  1.440,  0.181},
		{ "HB2",  0.999,  4.214,  0.785},
		{ "HB1",  -0.277,  3.266,  1.002},
		{ "HG",  -1.618,  3.666,  0.387},
		{ "HD13",  -1.970,  5.030,  0.873},
		{ "HD12",  -2.270,  5.876,  0.589},
		{ "HD11",  -0.746,  6.106,  0.740},
		{ "HD23",  0.668,  5.733,  0.359},
		{ "HD22",  -0.935,  6.001,  0.232},
		{ "HD21",  0.135,  4.849,  0.080},
	})));
	_db.insert(_res('M',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.933,  2.282,  0.466},
		{ "C",  1.911,  1.626,  0.963},
		{ "O",  3.095,  1.885,  0.883},
		{ "CB",  0.222,  3.387,  0.768},
		{ "CG",  -0.732,  4.265,  0.542},
		{ "SD",  0.101,  5.355,  0.289},
		{ "CE",  1.257,  6.259,  0.476},
		{ "HA",  1.490,  2.973,  0.214},
		{ "H",  -0.977,  1.544,  0.137},
		{ "HB2",  0.981,  4.105,  0.862},
		{ "HB1",  -0.358,  3.141,  1.046},
		{ "HG2",  -1.165,  5.040,  0.683},
		{ "HG1",  -1.563,  3.740,  0.418},
		{ "HE3",  0.729,  6.775,  0.601},
		{ "HE2",  1.672,  7.081,  0.385},
		{ "HE1",  2.080,  5.645,  0.541},
	})));
	_db.insert(_res('N',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.948,  2.326,  0.449},
		{ "C",  1.942,  1.694,  0.928},
		{ "O",  3.148,  1.800,  0.841},
		{ "H",  -0.477,  0.752,  0.474},
		{ "HA",  1.494,  2.984,  0.184},
		{ "CB",  0.243,  3.477,  0.720},
		{ "HB1",  -0.434,  3.998,  0.534},
		{ "HB2",  1.006,  4.240,  0.780},
		{ "CG",  -0.535,  3.369,  1.100},
		{ "OD2",  -0.005,  4.017,  1.342},
		{ "ND1",  -1.799,  2.906,  1.124},
		{ "HD1",  -2.252,  2.576,  0.819},
		{ "HD2",  -2.294,  3.144,  1.401},
	})));
	_db.insert(_res('O',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.947,  2.308,  0.444},
		{ "C",  1.917,  1.661,  0.940},
		{ "O",  3.102,  1.908,  0.855},
		{ "CB",  0.242,  3.451,  0.721},
		{ "CG",  -0.645,  4.320,  0.478},
		{ "CD",  -1.510,  5.312,  0.650},
		{ "CE",  -2.471,  6.121,  0.490},
		{ "NZ",  -3.334,  7.021,  0.612},
		{ "HA",  1.506,  2.980,  0.186},
		{ "H",  -0.957,  1.471,  0.178},
		{ "HB2",  1.001,  4.172,  0.813},
		{ "HB1",  -0.369,  3.228,  0.988},
		{ "HG2",  -1.317,  3.804,  0.304},
		{ "HG1",  -0.005,  4.988,  0.348},
		{ "HD2",  -0.851,  6.067,  0.731},
		{ "HD1",  -2.112,  4.877,  0.810},
		{ "HE2",  -3.107,  5.498,  0.378},
		{ "HE1",  -1.882,  6.791,  0.389},
		{ "HZ3",  -3.936,  6.560,  0.725},
		{ "HZ2",  -4.019,  7.560,  0.524},
		{ "HZ1",  -2.751,  7.795,  0.676},
	})));
	_db.insert(_res('P',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.411,  1.867,  0.295},
		{ "C",  1.762,  1.962,  1.090},
		{ "O",  0.887,  2.164,  1.520},
		{ "CB",  1.482,  3.388,  0.297},
		{ "CG",  0.041,  3.764,  0.404},
		{ "CD",  -0.812,  2.773,  0.156},
		{ "HA",  2.139,  1.587,  -0.143},
		{ "HB1",  2.160,  3.805,  0.510},
		{ "HB2",  1.672,  3.881,  0.031},
		{ "HG1",  -0.227,  3.726,  0.690},
		{ "HG2",  -0.114,  4.791,  0.320},
		{ "HD1",  -1.750,  2.547,  0.358},
		{ "HD2",  -0.967,  3.433,  -0.126},
	})));
	_db.insert(_res('Q',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.932,  2.292,  0.461},
		{ "C",  1.945,  1.628,  0.932},
		{ "O",  3.134,  1.785,  0.797},
		{ "CB",  0.234,  3.389,  0.768},
		{ "CG",  -0.593,  4.374,  0.542},
		{ "CD",  -1.534,  5.262,  0.707},
		{ "OE1",  -2.508,  5.692,  0.597},
		{ "NE2",  -1.306,  5.805,  0.928},
		{ "HA",  1.459,  2.997,  0.206},
		{ "H",  -0.980,  1.619,  0.116},
		{ "HB2",  1.012,  4.047,  0.880},
		{ "HB1",  -0.418,  3.126,  1.029},
		{ "HG2",  -1.198,  3.942,  0.347},
		{ "HG1",  0.090,  5.088,  0.439},
		{ "HE21",  -0.512,  5.657,  1.031},
		{ "HE22",  -1.955,  6.518,  0.972},
	})));
	_db.insert(_res('R',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.416,  1.596,  0.225},
		{ "C",  1.616,  2.015,  1.050},
		{ "O",  0.672,  2.525,  1.316},
		{ "CB",  1.985,  3.007,  0.077},
		{ "CG",  3.533,  3.130,  0.098},
		{ "CD",  4.008,  4.580,  0.046},
		{ "NE",  5.499,  4.632,  0.058},
		{ "CZ",  6.234,  5.734,  0.038},
		{ "NH1",  5.730,  6.928,  0.017},
		{ "NH2",  7.523,  5.621,  0.048},
		{ "H",  -0.326,  2.124,  -0.443},
		{ "HA",  1.937,  0.948,  -0.377},
		{ "HB1",  1.643,  3.517,  -0.208},
		{ "HB2",  1.517,  3.772,  0.272},
		{ "HG1",  3.904,  2.951,  0.439},
		{ "HG2",  3.985,  2.558,  -0.199},
		{ "HD1",  3.629,  5.079,  -0.145},
		{ "HD2",  3.559,  5.266,  0.199},
		{ "HE",  6.050,  3.779,  0.092},
		{ "HH11",  6.363,  7.728,  0.011},
		{ "HH12",  4.708,  6.950,  0.012},
		{ "HH21",  7.899,  4.681,  0.074},
		{ "HH22",  8.072,  6.480,  0.035},
	})));
	_db.insert(_res('S',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.225,  2.074,  0.344},
		{ "C",  1.650,  1.881,  1.087},
		{ "O",  1.008,  1.813,  1.663},
		{ "CB",  1.056,  3.606,  0.401},
		{ "OG",  0.160,  4.124,  0.658},
		{ "H",  -0.499,  0.664,  0.284},
		{ "HA",  2.031,  2.046,  -0.026},
		{ "HB1",  2.041,  4.080,  0.449},
		{ "HB2",  0.716,  4.159,  0.169},
		{ "HG",  -0.707,  3.729,  0.625},
	})));
	_db.insert(_res('T',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.228,  2.069,  0.343},
		{ "C",  1.643,  1.888,  1.089},
		{ "O",  1.000,  1.825,  1.651},
		{ "CB",  1.051,  3.615,  0.406},
		{ "OG1",  0.772,  4.381,  0.112},
		{ "CG2",  2.273,  4.433,  0.524},
		{ "H",  -0.507,  0.671,  0.293},
		{ "HA",  2.037,  2.045,  -0.025},
		{ "HB",  0.192,  3.874,  0.581},
		{ "HG1",  0.606,  5.245,  0.193},
		{ "HG21",  2.080,  5.520,  0.508},
		{ "HG22",  2.557,  4.392,  0.766},
		{ "HG23",  3.163,  4.253,  0.378},
	})));
	_db.insert(_res('U',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.240,  2.044,  0.344},
		{ "C",  1.604,  1.920,  1.098},
		{ "O",  2.805,  2.688,  1.146},
		{ "CB",  1.076,  3.574,  0.377},
		{ "SEG",  2.635,  4.388,  0.481},
		{ "H",  -0.547,  0.711,  0.326},
		{ "HA",  2.055,  1.955,  -0.029},
		{ "HB1",  0.759,  4.104,  0.137},
		{ "HB2",  0.290,  3.934,  0.563},
		{ "HG",  2.305,  4.962,  0.729},
	})));
	_db.insert(_res('V',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.246,  2.028,  0.345},
		{ "C",  1.579,  1.942,  1.104},
		{ "O",  0.854,  1.945,  1.626},
		{ "CB",  1.137,  3.601,  0.378},
		{ "CG1",  0.990,  4.498,  0.065},
		{ "CG2",  2.309,  4.401,  0.538},
		{ "H",  -0.572,  0.737,  0.343},
		{ "HA",  2.070,  1.900,  -0.027},
		{ "HB",  0.220,  3.885,  0.528},
		{ "HG11",  1.892,  4.613,  -0.073},
		{ "HG12",  0.135,  4.338,  -0.089},
		{ "HG13",  0.806,  5.520,  0.142},
		{ "HG21",  3.282,  4.161,  0.428},
		{ "HG22",  2.158,  5.489,  0.509},
		{ "HG23",  2.419,  4.421,  0.788},
	})));
	_db.insert(_res('W',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.246,  2.034,  0.341},
		{ "C",  1.601,  1.924,  1.099},
		{ "O",  0.894,  1.916,  1.630},
		{ "CB",  1.088,  3.574,  0.392},
		{ "CG",  0.917,  4.497,  0.089},
		{ "CD1",  -0.313,  5.053,  0.002},
		{ "CD2",  1.885,  5.143,  -0.065},
		{ "NE1",  -0.133,  6.139,  -0.156},
		{ "CE2",  1.238,  6.200,  -0.187},
		{ "CE3",  3.293,  4.979,  -0.080},
		{ "CZ2",  1.996,  7.193,  -0.286},
		{ "CZ3",  4.022,  5.914,  -0.215},
		{ "CH2",  3.384,  7.044,  -0.298},
		{ "H",  -0.517,  0.782,  0.288},
		{ "HA",  2.067,  1.947,  -0.031},
		{ "HB1",  0.238,  3.884,  0.564},
		{ "HB2",  1.970,  4.047,  0.517},
		{ "HD1",  -1.275,  4.736,  0.080},
		{ "HE1",  -0.851,  6.770,  -0.213},
		{ "HE3",  3.791,  4.228,  0.050},
		{ "HZ2",  1.509,  8.081,  -0.334},
		{ "HZ3",  5.095,  5.818,  -0.228},
		{ "HH2",  3.975,  7.842,  -0.355},
	})));
	_db.insert(_res('Y',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  1.230,  2.066,  0.343},
		{ "C",  1.638,  1.892,  1.091},
		{ "O",  0.981,  1.837,  1.656},
		{ "CB",  1.043,  3.595,  0.425},
		{ "CG",  0.707,  4.570,  0.145},
		{ "CD1",  1.704,  5.199,  -0.010},
		{ "CD2",  -0.611,  5.023,  0.121},
		{ "CE1",  1.383,  6.374,  -0.127},
		{ "CE2",  -0.930,  6.111,  -0.025},
		{ "CZ",  0.068,  6.830,  -0.126},
		{ "OH",  -0.244,  8.039,  -0.201},
		{ "H",  -0.512,  0.676,  0.298},
		{ "HA",  2.042,  2.054,  -0.023},
		{ "HB1",  0.272,  3.867,  0.627},
		{ "HB2",  1.961,  4.059,  0.533},
		{ "HD1",  2.727,  4.850,  -0.004},
		{ "HD2",  -1.394,  4.610,  0.251},
		{ "HE1",  2.150,  6.976,  -0.196},
		{ "HE2",  -1.953,  6.455,  -0.029},
		{ "HH",  -1.185,  8.185,  -0.187},
	})));
	_db.insert(_res('Z',vector<Atom>({
		{ "N",  0.000,  1.576,  0.000},
		{ "CA",  0.932,  2.292,  0.461},
		{ "C",  1.945,  1.628,  0.932},
		{ "O",  3.134,  1.785,  0.797},
		{ "CB",  0.234,  3.389,  0.768},
		{ "CG",  -0.593,  4.374,  0.542},
		{ "CD",  -1.534,  5.262,  0.707},
		{ "OE1",  -2.508,  5.692,  0.597},
		{ "HA",  1.459,  2.997,  0.206},
		{ "H",  -0.980,  1.619,  0.116},
		{ "HB2",  1.012,  4.047,  0.880},
		{ "HB1",  -0.418,  3.126,  1.029},
		{ "HG2",  -1.198,  3.942,  0.347},
		{ "HG1",  0.090,  5.088,  0.439},
	})));





//		_db.insert(_res('H',vector<Atom>({
//			{"N",0.000,  1.576,  0.000},
//			{"C",1.000,  1.576,  0.000}
//		})
//		));
//		_db.insert(_res('A',vector<Atom>({
//          { "N", 0.000,  1.576,  0.000},
//          { "CA", 0.963,  2.292,  0.440},
//          { "C", 1.963,  1.608,  0.913},
//          { "O", 3.153,  1.742,  0.774},
//          { "CB", 0.285,  3.409,  0.741},
//          { "HA", 1.478,  2.999,  0.183},
//          { "H",  -0.969,  1.563,  0.159},
//          { "HB3", -0.234,  3.243,  1.029},
//          { "HB2", -0.449,  3.921,  0.565},
//          { "HB1", 1.041,  4.176,  0.802}
//		})));
//		_db.insert(_res('B',vector<Atom>({
//			{ "N", 0.000,  1.576,  0.000},
//			{ "CA", 0.963,  2.292,  0.440},
//			{ "C", 1.963,  1.608,  0.913},
//			{ "O", 3.153,  1.742,  0.774},
//			{ "CB", 0.285,  3.409,  0.741},
//			{ "HA", 1.478,  2.999,  0.183},
//			{ "H", -0.969,  1.563,  0.159},
//			{ "HB3", -0.234,  3.243,  1.029},
//			{ "HB2", -0.449,  3.921,  0.565},
//			{ "HB1", 1.041,  4.176,  0.802}
//		})));

	}
	Residue GetRes(char r) {
		return _db[r];
	}
	
};
//static ResidueDB RDB;